<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>B&M Trading LLP â€” Shop</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #fafafa; color: #222; }
    header, .top-bar, footer { background: #111; color: #fff; text-align: center; padding: 10px 0; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 15px 30px; }
    header .logo { font-size: 1.5em; font-weight: bold; }
    header nav a { color: #fff; text-decoration: none; margin: 0 10px; }
    header nav a:hover { text-decoration: underline; }
    .hero { background: url('https://images.unsplash.com/photo-1606813902913-831d3d0e49d4?auto=format&fit=crop&w=1950&q=80') center/cover; color: #fff; text-align: center; padding: 100px 20px; }
    .hero h1 { font-size: 2em; margin-bottom: 10px; }
    .hero .btn { background: #ff6a00; color: #fff; padding: 12px 20px; border-radius: 5px; text-decoration: none; font-weight: bold; }
    .offer { background: #ff6a00; color: #fff; padding: 10px; text-align: center; font-weight: 500; }
    .products { padding: 40px 20px; max-width: 1200px; margin: auto; }
    .products h2 { text-align: center; margin-bottom: 20px; }
    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
    .product { background: #fff; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; padding: 15px; }
    .product-thumb img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
    .product h3 { margin: 10px 0; font-size: 1.1em; }
    .price { color: #ff6a00; font-weight: bold; }
    .add-cart { background: #007bff; color: #fff; border: none; padding: 8px 12px; cursor: pointer; border-radius: 5px; margin-top: 10px; }
    .add-cart:hover { background: #0056b3; }
    .about, .contact { padding: 40px 20px; max-width: 1000px; margin: auto; }
    .whatsapp { position: fixed; bottom: 15px; right: 15px; background: #25D366; color: white; padding: 12px 15px; border-radius: 50px; text-decoration: none; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
    footer p { margin: 0; font-size: 0.9em; }
  </style>
</head>
<body>
  <div class="top-bar">
    <p>Seen it cheaper? Ask for a B&M Trading deal. <a href="#" style="color:#ff6a00;">Live chat</a> or call <strong>0720 300 388</strong></p>
  </div>

  <header>
    <div class="logo">B&M Trading LLP</div>
    <nav>
      <a href="index.html">Home</a>
      <a href="add-product.html">Add Product</a>
      <a href="cart.html">ðŸ›’ Cart</a>
    </nav>
  </header>

  <section class="hero">
    <div class="hero-content">
      <h1>The Latest Apple & Tech Products</h1>
      <p>Shop premium iPhones, MacBooks and accessories in Nairobi.</p>
      <a href="#products" class="btn">Shop Now</a>
    </div>
  </section>

  <section class="offer">
    <h2>FREE Delivery On All Orders Above KSh 20,000</h2>
  </section>

  <section id="products" class="products">
    <h2>Trending Now</h2>
    <div id="product-grid" class="product-grid"></div>
    <p id="no-products" style="display:none;text-align:center;color:#666;">No products yet â€” add some from the Add Product page.</p>
  </section>

  <section id="about" class="about">
    <h2>About B&M Trading LLP</h2>
    <p>We are a trusted electronics company based in Nairobi, dealing in authentic Apple products and accessories. Visit us at Queensway House, Kaunda Street.</p>
  </section>

  <section id="contact" class="contact">
    <h2>Contact Us</h2>
    <p><strong>Address:</strong> Queensway House, Kaunda St, Nairobi</p>
    <p><strong>Phone:</strong> 0720 300 388</p>
    <iframe src="https://www.google.com/maps?q=Queensway+House,+Nairobi&output=embed" width="100%" height="250" style="border:0;"></iframe>
  </section>

  <a href="https://wa.me/254720300388" class="whatsapp" target="_blank" rel="noopener">ðŸ’¬ WhatsApp Us</a>

  <footer>
    <p>Â© 2025 B&M Trading LLP | All Rights Reserved</p>
  </footer>

  <!-- Firebase + App logic -->
  <script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCjf6QOf7gdq1StOBdf5zWtWyde-Gis0Nc",
      authDomain: "bm-trading-llp.firebaseapp.com",
      projectId: "bm-trading-llp",
      storageBucket: "bm-trading-llp.firebasestorage.app",
      messagingSenderId: "760421393441",
      appId: "1:760421393441:web:bda19fd259add66b892f60",
      measurementId: "G-FXSZ8BFMK2"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Helper functions
    function formatNumber(n){ try { return Number(n).toLocaleString(); } catch(e){ return n; } }
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c])); }

    async function loadProducts() {
      const grid = document.getElementById("product-grid");
      const noProducts = document.getElementById("no-products");
      grid.innerHTML = "";

      try {
        const q = query(collection(db, "products"), orderBy("createdAt", "desc"));
        const snap = await getDocs(q);

        if (snap.empty) {
          noProducts.style.display = "block";
          return;
        } else {
          noProducts.style.display = "none";
        }

        snap.forEach(doc => {
          const data = doc.data();
          const div = document.createElement("div");
          div.className = "product";
          div.innerHTML = `
            <div class="product-thumb"><img src="${data.imageURL}" alt="${escapeHtml(data.name)}"></div>
            <h3>${escapeHtml(data.name)}</h3>
            <p class="price">KSh ${formatNumber(data.price)}</p>
            <button class="add-cart"
              data-id="${doc.id}"
              data-name="${escapeHtml(data.name)}"
              data-price="${data.price}"
              data-image="${data.imageURL}">
              Add to Cart
            </button>
          `;
          grid.appendChild(div);
        });
      } catch (err) {
        console.error("Error loading products:", err);
        grid.innerHTML = "<p style='color:red'>Failed to load products.</p>";
      }
    }

    // Add to Cart functionality
    document.addEventListener("click", (e) => {
      if (e.target.classList.contains("add-cart")) {
        const product = {
          id: e.target.dataset.id,
          name: e.target.dataset.name,
          price: parseFloat(e.target.dataset.price),
          image: e.target.dataset.image,
          quantity: 1
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(item => item.id === product.id);

        if (existing) {
          existing.quantity++;
        } else {
          cart.push(product);
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`${product.name} added to cart!`);
      }
    });

    loadProducts();
  </script>
</body>
</html>

